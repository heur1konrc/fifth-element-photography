<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard V3 - Fifth Element Photography</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin_v3.css') }}">
</head>
<body>
    <!-- Header -->
    <header class="admin-header">
        <div class="header-content">
            <h1>Fifth Element Photography - Admin V3</h1>
            <div class="header-actions">
                <span class="version-badge">v3.0.0-alpha</span>
                <a href="{{ url_for('logout_v3') }}" class="btn-logout">Logout</a>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="admin-container">
        
        <!-- Toolbar -->
        <div class="toolbar">
            <div class="toolbar-left">
                <button id="btn-upload" class="btn btn-primary">
                    <span class="icon">üì§</span> Upload Images
                </button>
                <button id="btn-manage-categories" class="btn btn-secondary">
                    <span class="icon">üè∑Ô∏è</span> Manage Categories
                </button>
                
                <button id="btn-backup" class="btn btn-success">
                    <span class="icon">üíæ</span> Create Backup
                </button>
                <button id="btn-manage-backups" class="btn btn-secondary">
                    <span class="icon">üì¶</span> Manage Backups
                </button>
                
                <button id="btn-lumaprints" class="btn btn-primary">
                    <span class="icon">üñºÔ∏è</span> Lumaprints Mapping
                </button>
            </div>
            
            <div class="toolbar-right">
                <input type="text" id="search-box" class="search-input" placeholder="üîç Search images...">
                
                <select id="filter-category" class="select-filter">
                    <option value="all">All Categories</option>
                </select>
                
                <select id="sort-order" class="select-sort">
                    <option value="newest">Newest First</option>
                    <option value="oldest">Oldest First</option>
                    <option value="name_asc">Name (A-Z)</option>
                    <option value="name_desc">Name (Z-A)</option>
                </select>
            </div>
        </div>

        <!-- Bulk Actions Bar (hidden by default) -->
        <div id="bulk-actions-bar" class="bulk-actions-bar" style="display: none;">
            <div class="bulk-actions-left">
                <span id="selected-count" class="selected-count">0 images selected</span>
                <button id="btn-select-all" class="btn btn-text">Select All</button>
                <button id="btn-deselect-all" class="btn btn-text">Deselect All</button>
            </div>
            <div class="bulk-actions-right">
                <button id="btn-bulk-assign-categories" class="btn btn-primary">
                    <span class="icon">üè∑Ô∏è</span> Assign Categories
                </button>
                <button id="btn-bulk-delete" class="btn btn-danger">
                    <span class="icon">üóëÔ∏è</span> Delete Selected
                </button>
            </div>
        </div>

        <!-- Image Gallery -->
        <div id="image-gallery" class="image-gallery">
            <div class="loading">Loading images...</div>
        </div>

        <!-- Pagination -->
        <div id="pagination" class="pagination"></div>
    </div>

    <!-- Upload Modal -->
    <div id="upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Upload Images</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="upload-area" id="upload-area">
                    <div class="upload-icon">üìÅ</div>
                    <p>Drag and drop images here or click to browse</p>
                    <input type="file" id="file-input" multiple accept=".jpg,.jpeg,.png,.gif,.webp" style="display: none;">
                    <button id="btn-browse" class="btn btn-primary">Browse Files</button>
                </div>
                <div id="upload-preview" class="upload-preview"></div>
                <div id="upload-status" class="upload-status"></div>
            </div>
            <div class="modal-footer">
                <button id="btn-upload-confirm" class="btn btn-primary">Upload</button>
                <button class="btn btn-secondary modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Edit Image Modal -->
    <div id="edit-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Edit Image</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="edit-layout">
                    <div class="edit-preview">
                        <img id="edit-image-preview" src="" alt="Image preview">
                        
                        <div class="form-group">
                            <label>EXIF Data</label>
                            <div id="edit-exif" class="exif-data"></div>
                        </div>
                    </div>
                    <div class="edit-form">
                        <div class="form-group">
                            <label for="edit-title">Title</label>
                            <input type="text" id="edit-title" class="form-input">
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-description">Description</label>
                            <textarea id="edit-description" class="form-textarea" rows="6"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>Categories</label>
                            <div id="edit-categories" class="category-checkboxes"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="featured-checkbox-label">
                                <input type="checkbox" id="edit-featured" class="featured-checkbox">
                                <span class="featured-text">‚≠ê Mark as Featured Image</span>
                            </label>
                        </div>
                        
                        <input type="hidden" id="edit-filename">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="btn-save-image" class="btn btn-primary">Save Changes</button>
                <button id="btn-delete-image" class="btn btn-danger">Delete Image</button>
                <button class="btn btn-secondary modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Manage Categories Modal -->
    <div id="categories-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Manage Categories</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="new-category-name">Add New Category</label>
                    <div class="input-group">
                        <input type="text" id="new-category-name" class="form-input" placeholder="Category name">
                        <button id="btn-add-category" class="btn btn-primary">Add</button>
                    </div>
                </div>
                
                <div class="category-list">
                    <h3>Current Categories</h3>
                    <div id="current-categories" class="categories-grid"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary modal-close">Close</button>
            </div>
        </div>
    </div>

    <!-- Bulk Assign Categories Modal -->
    <div id="bulk-assign-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Assign Categories to Selected Images</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p class="modal-description">Select categories to assign to <span id="bulk-assign-count">0</span> selected image(s):</p>
                <div class="form-group">
                    <label>Categories</label>
                    <div id="bulk-assign-categories" class="category-checkboxes"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="btn-bulk-assign-confirm" class="btn btn-primary">Assign to Selected</button>
                <button class="btn btn-secondary modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Backup Success Modal -->
    <div id="backup-success-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚úì Backup Created Successfully</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p><strong>Filename:</strong> <span id="backup-filename"></span></p>
                <p><strong>Size:</strong> <span id="backup-size"></span> MB</p>
                <p style="margin-top: 20px;">Click the button below to download your backup:</p>
            </div>
            <div class="modal-footer">
                <a id="btn-download-backup" href="#" class="btn btn-primary" download>Download Backup</a>
                <button class="btn btn-secondary modal-close">Close</button>
            </div>
        </div>
    </div>

    <!-- Manage Backups Modal -->
    <div id="manage-backups-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>üì¶ Manage Backups</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="backups-summary" style="margin-bottom: 20px; padding: 10px; background: #f5f5f5; border-radius: 4px;">
                    <strong>Total Backups:</strong> <span id="backups-count">0</span> &nbsp;|&nbsp; 
                    <strong>Total Size:</strong> <span id="backups-total-size">0</span> MB
                </div>
                <div id="backups-list" style="max-height: 400px; overflow-y: auto;">
                    <!-- Backups will be loaded here -->
                </div>
            </div>
            <div class="modal-footer">
                <button id="btn-refresh-backups" class="btn btn-secondary">Refresh</button>
                <button class="btn btn-secondary modal-close">Close</button>
            </div>
        </div>
    </div>

    <!-- Lumaprints Mapping Modal -->
    <div id="lumaprints-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>üñºÔ∏è Lumaprints Bulk Mapping</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Step 1: Upload Excel -->
                <div id="lumaprints-step-1" class="lumaprints-step">
                    <h3>Step 1: Upload Lumaprints Excel File</h3>
                    <p>Upload the .xlsx file exported from Lumaprints.</p>
                    <input type="file" id="lumaprints-file-input" accept=".xlsx" style="margin: 20px 0;">
                    <button id="btn-lumaprints-upload" class="btn btn-primary">Upload & Process</button>
                    <div id="lumaprints-upload-status" style="margin-top: 10px;"></div>
                </div>

                <!-- Step 2: Map Products -->
                <div id="lumaprints-step-2" class="lumaprints-step" style="display: none;">
                    <h3>Step 2: Map Unmapped Products</h3>
                    <p id="lumaprints-unmapped-count"></p>
                    
                    <div style="margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 4px;">
                        <h4>Bulk Mapping Form</h4>
                        <p style="color: #666; font-size: 0.9em;">This will apply ALL product types (Canvas + all Art Paper types) to all unmapped products in one shot.</p>
                        
                        <div style="margin-bottom: 15px;">
                            <label><strong>Image Filename:</strong></label>
                            <input type="text" id="lumaprints-image-input" placeholder="Enter image filename (e.g., IMG_1234.jpg)" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ddd; border-radius: 4px;" />
                            <small style="color: #666; display: block; margin-top: 5px;">Enter the exact filename as it appears in your Lumaprints Library</small>
                        </div>

                        <div style="margin-bottom: 15px;">
                            <label><strong>Aspect Ratio:</strong></label>
                            <select id="lumaprints-aspect-ratio" class="select-filter" style="width: 100%; margin-top: 5px;">
                                <option value="3:2">3:2 (Landscape/Portrait) - 5 sizes</option>
                                <option value="1:1">1:1 (Square) - 4 sizes</option>
                            </select>
                        </div>

                        <div style="margin-top: 20px; padding: 10px; background: #e8f5e9; border-radius: 4px;">
                            <strong>Will apply:</strong>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>0.75in Stretched Canvas (all sizes)</li>
                                <li>Hot Press Fine Art Paper (all sizes)</li>
                                <li>Semi-Glossy Fine Art Paper (all sizes)</li>
                                <li>Glossy Fine Art Paper (all sizes)</li>
                            </ul>
                        </div>

                        <div style="margin-top: 20px;">
                            <button id="btn-lumaprints-apply-all" class="btn btn-success btn-large">‚úì Apply to All Unmapped Products</button>
                        </div>
                    </div>

                    <div id="lumaprints-products-list" style="max-height: 400px; overflow-y: auto; margin-top: 20px;">
                        <!-- Unmapped products will be listed here -->
                    </div>
                </div>

                <!-- Step 3: Download -->
                <div id="lumaprints-step-3" class="lumaprints-step" style="display: none;">
                    <h3>Step 3: Download Mapped File</h3>
                    <p>‚úì Successfully mapped <span id="lumaprints-mapped-count">0</span> products!</p>
                    <p>Download the updated Excel file and upload it to Lumaprints.</p>
                    <button id="btn-lumaprints-download" class="btn btn-primary">Download Excel File</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary modal-close">Close</button>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="notification" class="notification"></div>

    <script src="{{ url_for('static', filename='js/admin_v3.js') }}"></script>
</body>
</html>


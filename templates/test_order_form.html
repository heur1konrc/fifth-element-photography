<!DOCTYPE html>
<html>
<head>
    <title>Test Order Form - OrderDesk Integration</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #007cba; color: white; padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #005a87; }
        .product-info { background: #f5f5f5; padding: 15px; margin: 15px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Test Order Form - OrderDesk Integration</h1>
    
    <div class="product-info">
        <h3>Test Product: Sparrow</h3>
        <p><strong>Product:</strong> Canvas Print 12x12</p>
        <p><strong>Price:</strong> $25.00</p>
        <p><strong>Image:</strong> https://fifthelement.photos/images/12x12_Sparrow.jpg</p>
    </div>

    <form action="/test_order_submit" method="POST">
        <h3>Customer Information</h3>
        
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
        </div>

        <h3>Shipping Address</h3>
        
        <div class="form-group">
            <label for="first_name">First Name:</label>
            <input type="text" id="first_name" name="first_name" required>
        </div>
        
        <div class="form-group">
            <label for="last_name">Last Name:</label>
            <input type="text" id="last_name" name="last_name" required>
        </div>
        
        <div class="form-group">
            <label for="address1">Address:</label>
            <input type="text" id="address1" name="address1" required>
        </div>
        
        <div class="form-group">
            <label for="city">City:</label>
            <input type="text" id="city" name="city" required>
        </div>
        
        <div class="form-group">
            <label for="state">State:</label>
            <input type="text" id="state" name="state" required>
        </div>
        
        <div class="form-group">
            <label for="postal_code">Zip Code:</label>
            <input type="text" id="postal_code" name="postal_code" required>
        </div>
        
        <div class="form-group">
            <label for="country">Country:</label>
            <select id="country" name="country" required>
                <option value="US">United States</option>
                <option value="CA">Canada</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="phone">Phone:</label>
            <input type="tel" id="phone" name="phone">
        </div>

        <h3>Product Selection</h3>
        
        <div class="form-group">
            <label for="product_type">Product Type:</label>
            <select id="product_type" name="product_type" required>
                <option value="101001">Canvas Print 0.75in (12x12) - $25.00</option>
                <option value="106001">Metal Print (12x12) - $35.00</option>
                <option value="103001">Fine Art Paper (12x12) - $20.00</option>
            </select>
        </div>

        <!-- PayPal Payment Section -->
        <div class="payment-section" style="margin-top: 20px; padding: 20px; border: 2px solid #0070ba; border-radius: 8px;">
            <h3>Payment</h3>
            <p><strong>Total: $25.00</strong></p>
            <div id="paypal-button-container"></div>
        </div>

        <!-- Hidden submit for after payment -->
        <button type="submit" id="submit-order" style="display: none;">Submit Order to OrderDesk</button>
    </form>

    <!-- PayPal SDK -->
    <script src="https://www.paypal.com/sdk/js?client-id=AVE6LeJKagwJXHf2BPamlaDQghtNBoRmRU8j5KK7wi7wDN61Ufm2dGZFi_CFH5L4MuKjh8KLhHLVwP5w&currency=USD&disable-funding=paylater"></script>
    
    <script>
        paypal.Buttons({
            style: {
                layout: 'vertical',
                color: 'blue',
                shape: 'rect',
                label: 'paypal'
            },
            createOrder: function(data, actions) {
                return actions.order.create({
                    purchase_units: [{
                        amount: {
                            value: '25.00'
                        },
                        description: 'Canvas Print 0.75in (12x12) - Sparrow'
                    }]
                });
            },
            onApprove: function(data, actions) {
                return actions.order.capture().then(function(details) {
                    // Payment successful
                    alert('Payment completed by ' + details.payer.name.given_name);
                    
                    // Add payment info to form
                    const form = document.querySelector('form');
                    const paymentInput = document.createElement('input');
                    paymentInput.type = 'hidden';
                    paymentInput.name = 'paypal_order_id';
                    paymentInput.value = data.orderID;
                    form.appendChild(paymentInput);
                    
                    const payerInput = document.createElement('input');
                    payerInput.type = 'hidden';
                    payerInput.name = 'paypal_payer_id';
                    payerInput.value = details.payer.payer_id;
                    form.appendChild(payerInput);
                    
                    // Submit order to OrderDesk
                    document.getElementById('submit-order').click();
                });
            },
            onError: function(err) {
                console.error('PayPal error:', err);
                alert('Payment failed. Please try again.');
            }
        }).render('#paypal-button-container');
    </script>
</body>
</html>
